<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"/>
<title>Referral Race</title>
<style>
  :root{
    --bg:#0c0c12; --ink:#eef2ff; --muted:#a0a7c9;
    --panel:#141424; --edge:rgba(255,255,255,.08);
    --p1:#8b5dff; --p2:#aa74ff; --glow:rgba(153,120,255,.3);
    --acc:#ffd86a; --good:#4be1a0;
  }
  *{box-sizing:border-box}
  html,body{margin:0;height:100%;overflow-x:hidden;
    background:radial-gradient(1000px 700px at 50% -10%, #1b1c3f 0%, transparent 60%),
               linear-gradient(180deg,#0b0c1a,#070813);
    color:var(--ink);font:15px/1.5 Inter,system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
    -webkit-tap-highlight-color:transparent}
  .app{max-width:520px;margin:0 auto;min-height:100dvh;display:grid;grid-template-rows:auto 1fr auto;overflow-x:hidden}

  header{position:sticky;top:0;background:linear-gradient(180deg,#10112a,#0d0e23);border-bottom:1px solid var(--edge);padding:12px 16px;z-index:20}
  .hrow{display:flex;align-items:center;justify-content:space-between}
  .title{font-weight:900;font-size:18px;letter-spacing:.4px}

  main{padding:14px 14px 96px}
  .card{background:linear-gradient(180deg,#151533,#10112a);border:1px solid var(--edge);border-radius:16px;padding:14px;margin-bottom:12px}
  h2{margin:0 0 8px;font-size:18px}
  h3{margin:0 0 8px;font-size:16px}
  p{margin:0 0 8px;color:#dfe5ff}

  /* ====== RANKING (namespaced .rr) ====== */
  .rr{--ink:#2b2350; --gold:#ffcf5a; --silver:#dbe6ff; --bronze:#ffd9b3; width:100%}
  .rr .controls{display:flex;align-items:center;gap:8px}
  .rr .select,.rr .wbtn{appearance:none;border:0;border-radius:10px;padding:9px 10px;font-weight:800}
  .rr .select{background:#ffffffbf;color:#2d1b55}
  .rr .wbtn{background:#ffd86a;color:#3a2400;box-shadow:0 4px 0 rgba(0,0,0,.12);cursor:pointer}
  .rr .wbtn:active{transform:translateY(1px);box-shadow:0 2px 0 rgba(0,0,0,.12)}

  .rr .podiumCard{margin-top:12px;border-radius:22px;padding:16px 12px 12px;width:100%;
    background:linear-gradient(180deg,#f0e6ff,#f9f1ff);border:1px solid rgba(255,255,255,.55);
    color:var(--ink);box-shadow:0 24px 60px rgba(36,18,66,.35);overflow:hidden}
  .rr .cap{display:flex;justify-content:center;gap:10px;align-items:center;color:#876dc9;
    font-weight:900;font-size:12px;letter-spacing:.4px;margin-bottom:10px}
  .rr .podium{display:grid;grid-template-columns:1fr 1.2fr 1fr;gap:10px;align-items:end}
  .rr .step{position:relative;border-radius:16px 16px 10px 10px;background:linear-gradient(180deg,#ffffff,#f0ecff);
    padding:10px 8px 12px;border:1px solid rgba(44,26,74,.12);
    box-shadow: inset 0 -12px 18px rgba(100,70,180,.10), 0 8px 18px rgba(0,0,0,.10);
    display:grid;place-items:center;min-height:86px}
  .rr .s1{min-height:120px}.rr .s2{min-height:100px}.rr .s3{min-height:96px}
  .rr .badge{position:absolute;top:-20px;left:50%;transform:translateX(-50%);width:58px;height:58px;border-radius:50%;
    display:grid;place-items:center;font-weight:900;border:2px solid rgba(0,0,0,.06);box-shadow:0 6px 14px rgba(0,0,0,.18)}
  .rr .b1{background:radial-gradient(circle at 35% 30%, #fff, var(--gold) 65%);color:#5a4300}
  .rr .b2{background:radial-gradient(circle at 35% 30%, #fff, var(--silver) 65%);color:#1d2945}
  .rr .b3{background:radial-gradient(circle at 35% 30%, #fff, var(--bronze) 65%);color:#4a2c12}

  .rr .av{position:absolute;top:-64px;left:50%;transform:translateX(-50%);width:76px;height:76px;border-radius:50%;
    border:4px solid #fff;box-shadow:0 10px 22px rgba(0,0,0,.25);background:#fff center/cover no-repeat}
  /* crown over avatar (top-3) */
  .rr .tiara{position:absolute;top:-86px;left:50%;transform:translateX(-50%);width:46px;height:30px;pointer-events:none}
  .rr .name{margin-top:14px;font-weight:900;color:#32245c;max-width:100%;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
  .rr .scoreMini{color:#6b5d9c;font-size:12px;margin-top:2px}

  .rr .swrap{margin-top:12px;position:relative;width:100%}
  .rr .hintRow{display:flex;justify-content:space-between;align-items:center;margin:2px 2px 6px;color:#efecffcc;font-size:12px}
  .rr .arrow{background:rgba(255,255,255,.25);border:1px solid rgba(255,255,255,.35);width:28px;height:28px;border-radius:50%;display:grid;place-items:center;cursor:pointer}
  .rr .arrow:active{transform:translateY(1px)}
  .rr .rail{display:grid;grid-auto-flow:column;grid-auto-columns:calc(50% - 10px);gap:10px;overflow:auto;padding:6px 6px 12px;
    scroll-snap-type:x mandatory;-webkit-overflow-scrolling:touch;overscroll-behavior-x:contain;max-width:100%}
  @media (min-width:560px){ .rr .rail{grid-auto-columns:calc(33.33% - 10px)} }
  .rr .rail::-webkit-scrollbar{height:0}
  .rr .rail{scrollbar-width:none}
  .rr .chip{scroll-snap-align:start;background:linear-gradient(180deg,rgba(255,255,255,.9),rgba(255,255,255,.75));
    border:1px solid rgba(0,0,0,.06);border-radius:14px;padding:10px;display:grid;
    grid-template-columns:42px 1fr auto;gap:8px;align-items:center;color:#2b2350;min-width:0}
  .rr .rk{display:grid;place-items:center;width:38px;height:38px;border-radius:12px;font-weight:900;background:#f0ecff;border:1px solid rgba(0,0,0,.06)}
  .rr .chip .av{position:static;width:38px;height:38px;border:2px solid #fff;box-shadow:none}
  .rr .uname{font-weight:800}
  .rr .val{font-weight:900;color:#5b4bb4}

  /* extra list (ranks 19–20) */
  .rr .more{margin-top:10px}
  .rr .row{display:grid;grid-template-columns:46px 1fr auto;gap:8px;align-items:center;
    background:linear-gradient(180deg,rgba(255,255,255,.08),rgba(255,255,255,.05));border:1px solid rgba(255,255,255,.1);
    border-radius:14px;padding:10px}
  .rr .row + .row{margin-top:8px}
  .rr .row .rk{width:38px;height:38px}

  .rr .search{margin-top:12px;display:grid;grid-template-columns:1fr auto;gap:8px}
  .rr .input{border-radius:12px;border:1px solid var(--edge);background:#0f1030;color:#eff3ff;padding:10px 12px}
  .rr .go{appearance:none;border:0;border-radius:12px;padding:10px 12px;background:#ffd86a;color:#3a2400;font-weight:900;cursor:pointer;box-shadow:0 4px 0 rgba(0,0,0,.12)}
  .rr .go:active{transform:translateY(1px);box-shadow:0 2px 0 rgba(0,0,0,.12)}
  .rr .result{margin-top:8px;background:rgba(255,255,255,.92);border:1px solid rgba(0,0,0,.08);color:#2b2350;border-radius:12px;padding:10px 12px;font-weight:700;display:none}

  nav{position:sticky;bottom:0;background:linear-gradient(180deg,#10112a,#0b0c1f);border-top:1px solid var(--edge);padding:8px 10px;z-index:30}
  .tabs{display:grid;grid-template-columns:repeat(4,1fr);gap:8px}
  .tab{appearance:none;border:1px solid var(--edge);background:#14143a;color:#cdd7ff;border-radius:12px;padding:10px 8px;font-weight:800;cursor:pointer}
  .tab.active{background:linear-gradient(180deg,var(--p2),var(--p1));color:#fff;box-shadow:0 6px 18px var(--glow)}

  details{background:#14143a;border:1px solid var(--edge);border-radius:12px;padding:10px}
  details+details{margin-top:8px}
  summary{cursor:pointer;font-weight:800}

  .socialCard{background: radial-gradient(120% 140% at 0% 0%, #5d2fff 0%, #4c22d8 35%, #3b1dbb 70%);border:1px solid rgba(255,255,255,.18);border-radius:20px;padding:12px;box-shadow:0 20px 50px rgba(0,0,0,.35)}
  .socialItem{display:grid;grid-template-columns:1fr auto;align-items:center;background:rgba(255,255,255,.08);border:1px solid rgba(255,255,255,.16);border-radius:14px;padding:10px 12px}
  .socialItem + .socialItem{margin-top:10px}
  .sLeft{display:flex;align-items:center;gap:10px;min-width:0}
  .sIcon{width:34px;height:34px;border-radius:10px;display:grid;place-items:center;background:#fff;color:#111;box-shadow:0 6px 14px rgba(0,0,0,.18)}
  .sName{font-weight:800;letter-spacing:.2px}
  .subBtn{appearance:none;border:0;padding:9px 14px;border-radius:10px;background:#fff;color:#222;font-weight:900;cursor:pointer;box-shadow:0 4px 0 rgba(0,0,0,.12)}
  .subBtn:active{transform:translateY(1px);box-shadow:0 2px 0 rgba(0,0,0,.12)}
</style>
</head>
<body>
<div class="app">
  <header>
    <div class="hrow">
      <div class="title" id="hdrTitle">Referral Ranking</div>
      <div class="muted" style="font-size:12px">v1 • demo</div>
    </div>
  </header>

  <main id="view"></main>

  <nav>
    <div class="tabs">
      <button type="button" class="tab active" data-tab="ranks">Ranks</button>
      <button type="button" class="tab" data-tab="home">Home</button>
      <button type="button" class="tab" data-tab="terms">T&amp;C</button>
      <button type="button" class="tab" data-tab="community">Community</button>
    </div>
  </nav>
</div>

<script>
/* ============ CONFIG (Google Sheets) ============ */
var SHEET_ID   = "YOUR_SHEET_ID_HERE"; // put your id later
var SHEET_NAME = "Referral";           // your tab name
var MAP = {
  rank:["rank","#"],
  username:["username","user","player","name"],
  points:["points","score","total","referrals"],
  avatar:["avatar","image","img","photo","icon","avatarurl"],
  week:["week","period"]                // e.g., Week 1, Week 2
};

/* helpers */
function $(s,el){return (el||document).querySelector(s)}
function $all(s,el){return [].slice.call((el||document).querySelectorAll(s))}
function fmt(n){n=Number(n||0);if(n>=1000)return (Math.round(n/100)/10).toLocaleString()+"K";return n.toLocaleString()}
function esc(s){return String(s==null?'':s).replace(/[&<>"']/g,m=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m]))}
function faceBg(url){return url?'url("'+url+'")':'url("data:image/svg+xml;utf8,'+encodeURIComponent(svgAvatar())+'")'}
function svgAvatar(){return "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'><defs><linearGradient id='g' x1='0' y1='0' x2='1' y2='1'><stop offset='0%' stop-color='%23a0c4ff'/><stop offset='100%' stop-color='%238f6bff'/></linearGradient></defs><rect width='64' height='64' rx='16' fill='url(%23g)'/><circle cx='32' cy='26' r='12' fill='white' opacity='.9'/><rect x='14' y='40' width='36' height='16' rx='8' fill='white' opacity='.9'/></svg>"}
function getParam(k){var m=location.search.match(new RegExp("[?&]"+k+"=([^&]+)","i"));return m?decodeURIComponent(m[1]):null}
function pickIndex(headers, aliases){var L=headers.map(h=>String(h||'').toLowerCase());for(var i=0;i<aliases.length;i++){var a=aliases[i];var j=L.findIndex(h=>h.indexOf(a)>-1);if(j>-1)return j;}return -1}

function fetchGViz(){
  var url="https://docs.google.com/spreadsheets/d/"+SHEET_ID+"/gviz/tq?tqx=out:json&sheet="+encodeURIComponent(SHEET_NAME);
  return fetch(url,{cache:"no-store"}).then(r=>r.text()).then(text=>{
    var jsonStr=(text.match(/google\.visualization\.Query\.setResponse\((.*)\);?/s)||[])[1];
    if(!jsonStr) throw new Error("GViz JSON parse failed");
    var data=JSON.parse(jsonStr);
    var headers=data.table.cols.map(c=>c.label||c.id||"");
    var rows=data.table.rows.filter(r=>r&&r.c).map(r=> r.c.map(c=> c?(c.f!=null?c.f:c.v):""));
    return {headers, rows};
  });
}
function normalize(payload){
  var h=payload.headers, rows=payload.rows;
  var ri=pickIndex(h,MAP.rank), ui=pickIndex(h,MAP.username), pi=pickIndex(h,MAP.points), ai=pickIndex(h,MAP.avatar), wi=pickIndex(h,MAP.week);
  if(ui<0 || pi<0 || wi<0) throw new Error("Missing required columns: Username, Points, Week");
  return rows.map(r=>{
    var pts=Number(String(r[pi]).replace(/[^\d.\-]/g,''))||0;
    return {
      rank:(ri>-1? Number(String(r[ri]).replace(/[^\d.\-]/g,'')) : null),
      username:String(r[ui]||"").trim(),
      points:pts,
      avatar:String((ai>-1? r[ai] :"")||"").trim(),
      week:String(r[wi]||"").trim()
    };
  }).filter(x=>x.username);
}

/* app state */
let state={tab:'ranks'}
let ALL=[],WEEKS=[],CUR_WEEK='',TOP100=[]

function render(){
  $('#hdrTitle').textContent = state.tab==='ranks' ? 'Referral Ranking' :
                               state.tab==='terms' ? 'Terms & FAQ' :
                               state.tab==='community' ? 'Community' : 'Referral Race';
  $all('.tab').forEach(b=>b.classList.toggle('active',b.dataset.tab===state.tab))
  if(state.tab==='ranks') renderRanks()
  else if(state.tab==='home') renderHome()
  else if(state.tab==='terms') renderTerms()
  else renderCommunity()
}

/* HOME */
function renderHome(){
  $('#view').innerHTML = `
    <div class="card">
      <h2>Referral Race</h2>
      <p>Invite friends, climb the leaderboard, and win weekly rewards.</p>
    </div>`;
}

/* RANKS (Weekly via Week column) */
function renderRanks(){
  $('#view').innerHTML = `
  <div class="rr">
    <div class="card"><div class="controls">
      <select id="weekSel" class="select"></select>
      <button id="prevBtn" class="wbtn" type="button">◀</button>
      <button id="nextBtn" class="wbtn" type="button">▶</button>
    </div></div>

    <div class="podiumCard">
      <div class="cap">Weekly Podium</div>
      <div class="podium">
        <div class="step s2">
          <div class="badge b2">2</div>
          <svg class="tiara" viewBox="0 0 64 36" fill="none"><path d="M5 32h54l-5-16-10 8-7-12-7 12-10-8-15 16z" fill="#E7EEF9"/><path d="M5 32h54l-5-16-10 8-7-12-7 12-10-8-15 16z" fill="#D7E3FF" opacity=".6"/><circle cx="32" cy="10" r="4" fill="#fff"/><circle cx="12" cy="15" r="3" fill="#fff"/><circle cx="52" cy="15" r="3" fill="#fff"/></svg>
          <div class="av" id="rr-p2a"></div><div class="name" id="rr-p2n">—</div><div class="scoreMini" id="rr-p2s"></div>
        </div>
        <div class="step s1">
          <div class="badge b1">1</div>
          <svg class="tiara" viewBox="0 0 64 36" fill="none"><path d="M5 32h54l-6-18-11 9-7-13-7 13-11-9-12 18z" fill="#FFE79B"/><path d="M5 32h54l-6-18-11 9-7-13-7 13-11-9-12 18z" fill="#FFD86A" opacity=".7"/><circle cx="32" cy="10" r="5" fill="#fff"/><circle cx="15" cy="14" r="3.5" fill="#fff"/><circle cx="49" cy="14" r="3.5" fill="#fff"/></svg>
          <div class="av" id="rr-p1a"></div><div class="name" id="rr-p1n">—</div><div class="scoreMini" id="rr-p1s"></div>
        </div>
        <div class="step s3">
          <div class="badge b3">3</div>
          <svg class="tiara" viewBox="0 0 64 36" fill="none"><path d="M5 32h54l-4-14-10 8-7-12-7 12-10-8-16 14z" fill="#FFE0C2"/><path d="M5 32h54l-4-14-10 8-7-12-7 12-10-8-16 14z" fill="#FFC99F" opacity=".6"/><circle cx="32" cy="10" r="4" fill="#fff"/><circle cx="13" cy="15" r="3" fill="#fff"/><circle cx="51" cy="15" r="3" fill="#fff"/></svg>
          <div class="av" id="rr-p3a"></div><div class="name" id="rr-p3n">—</div><div class="scoreMini" id="rr-p3s"></div>
        </div>
      </div>
    </div>

    <div class="swrap">
      <div class="hintRow"><div>Top 15 — swipe ▶</div><div><button class="arrow" id="rr-left">⬅</button> <button class="arrow" id="rr-right">➡</button></div></div>
      <div class="rail" id="rr-rail"></div>
    </div>

    <div class="more" id="rr-more"></div>

    <div class="search"><input id="rr-q" class="input" placeholder="Search username (top 100)…"/><button id="rr-find" class="go" type="button">Find</button></div>
    <div id="rr-mine" class="result"></div>
  </div>`;

  if(!ALL.length){
    fetchGViz()
      .then(normalize)
      .then(items=>{ ALL=items; buildWeeks(); fillWeekUI(); })
      .catch(err=>{
        console.warn('Sheets failed, demo used:', err.message);
        let demo=[];
        function seed(week,arr){ arr.forEach(x=>{ x.week=week; demo.push(x); }); }
        seed('Week 1',[
          {username:'evelin0510',points:1000000},
          {username:'송도르',points:502000},
          {username:'Gumiya',points:391200},
          {username:'Deathaura',points:282700},
          {username:'Player1063389294',points:200000},
          {username:'薇樂莉Jo',points:140000},
          {username:'talia bentley',points:130200},
          {username:'U8',points:120000},{username:'U9',points:118000},{username:'U10',points:110000},
          {username:'U11',points:108000},{username:'U12',points:104000},{username:'U13',points:101000},
          {username:'U14',points:98000},{username:'U15',points:96000},{username:'U16',points:92000},
          {username:'U17',points:90000},{username:'U18',points:88000},{username:'U19',points:86000},{username:'U20',points:84000}
        ]);
        seed('Week 2', demo.slice(0,20).map(x=>({username:x.username,points:Math.round(x.points*0.92)})));
        seed('Week 3', demo.slice(0,20).map(x=>({username:x.username,points:Math.round(x.points*1.05)})));
        ALL=demo; buildWeeks(); fillWeekUI();
      });
  } else { buildWeeks(); fillWeekUI(); }

  function buildWeeks(){
    let set={}, list=[];
    ALL.forEach(x=>{ if(x.week) set[x.week]=true; });
    for(const k in set) list.push(k);
    list.sort((a,b)=>{ const na=(a.match(/\d+/)||[])[0], nb=(b.match(/\d+/)||[])[0]; if(na&&nb) return na-nb; return a.localeCompare(b); });
    WEEKS=list;
    const fromParam=getParam('week');
    CUR_WEEK = fromParam && WEEKS.includes(fromParam) ? fromParam : (WEEKS[WEEKS.length-1]||'');
  }

  function fillWeekUI(){
    const sel = $('#weekSel'); sel.innerHTML='';
    WEEKS.forEach(w=>{ const o=document.createElement('option'); o.value=w; o.textContent=w; sel.appendChild(o); });
    sel.value=CUR_WEEK;
    renderWeek();

    $('#rr-left').onclick = ()=> $('#rr-rail').scrollBy({left:-220,behavior:'smooth'});
    $('#rr-right').onclick = ()=> $('#rr-rail').scrollBy({left:220,behavior:'smooth'});
    $('#rr-find').onclick = findUser;
    $('#rr-q').addEventListener('keydown',e=>{ if(e.key==='Enter') findUser(); });
    $('#weekSel').onchange = function(){ CUR_WEEK=this.value; renderWeek(); };
    $('#prevBtn').onclick = function(){ const i=WEEKS.indexOf(CUR_WEEK); if(i>0){ CUR_WEEK=WEEKS[i-1]; sel.value=CUR_WEEK; renderWeek(); } };
    $('#nextBtn').onclick = function(){ const i=WEEKS.indexOf(CUR_WEEK); if(i<WEEKS.length-1){ CUR_WEEK=WEEKS[i+1]; sel.value=CUR_WEEK; renderWeek(); } };
  }

  function byWeek(week){
    const arr = ALL.filter(x=>x.week===week).sort((a,b)=>b.points-a.points);
    arr.forEach((x,i)=>{ if(x.rank==null) x.rank=i+1; });
    return arr;
  }

  function renderWeek(){
    const items = byWeek(CUR_WEEK);
    function setPod(id,row){
      $('#rr-p'+id+'a').style.backgroundImage = faceBg(row?row.avatar:'');
      $('#rr-p'+id+'n').textContent = row?row.username:'—';
      $('#rr-p'+id+'s').textContent = row? (fmt(row.points)+' pts') : '';
    }
    setPod(1,items[0]||null); setPod(2,items[1]||null); setPod(3,items[2]||null);

    // Swipe shows ranks 4..18 (Top 15 after podium)
    const rail = $('#rr-rail'); rail.innerHTML='';
    items.slice(3,18).forEach(r=>{
      const div=document.createElement('div'); div.className='chip';
      div.innerHTML = '<div class="rk">'+r.rank+'</div>'+
        '<div style="display:flex;align-items:center;gap:8px"><div class="av" style="position:static;width:38px;height:38px;border:2px solid #fff;box-shadow:none;background-image:'+faceBg(r.avatar)+'"></div><div class="uname">'+esc(r.username)+'</div></div>'+
        '<div class="val">'+fmt(r.points)+'</div>';
      rail.appendChild(div);
    });

    // Extra list ranks 19..20 (scroll down)
    const more = $('#rr-more'); more.innerHTML='';
    items.slice(18,20).forEach(r=>{
      const row=document.createElement('div'); row.className='row';
      row.innerHTML='<div class="rk">'+r.rank+'</div>'+
        '<div style="display:flex;align-items:center;gap:8px"><div class="av" style="position:static;width:38px;height:38px;border:2px solid #fff;box-shadow:none;background-image:'+faceBg(r.avatar)+'"></div><div class="uname">'+esc(r.username)+'</div></div>'+
        '<div class="val">'+fmt(r.points)+'</div>';
      more.appendChild(row);
    });

    TOP100 = items.slice(0,100);
    document.documentElement.scrollLeft = 0; document.body.scrollLeft = 0;
  }

  function findUser(){
    const q = ($('#rr-q').value||'').trim().toLowerCase();
    const res = $('#rr-mine');
    if(!q){ res.style.display='block'; res.textContent='Enter a username'; return; }
    const hit = TOP100.find(x=>x.username.toLowerCase()===q);
    if(!hit){ res.style.display='block'; res.textContent='No match in Top 100.'; return; }
    res.style.display='block';
    res.innerHTML = '<b>'+esc(hit.username)+'</b> — Rank <b>'+hit.rank+'</b> • '+fmt(hit.points)+' pts • '+esc(hit.week);
    if(hit.rank>=4 && hit.rank<=18){
      const el=$('#rr-rail').children[hit.rank-4]; if(el){ el.scrollIntoView({behavior:'smooth',inline:'center'}); }
    }
  }
}

/* TERMS */
function renderTerms(){
  $('#view').innerHTML = `
  <div class="card"><h2>Terms & Conditions</h2><p>By joining the Referral Race, you agree to the rules below.</p></div>
  <div class="card"><h3>FAQ</h3>
    <details open><summary>How do I earn points?</summary><p>Each verified signup via your link grants <b>+1 point</b>. Bonus events may add extra points.</p></details>
    <details><summary>When are winners announced?</summary><p>Weekly winners every Monday.</p></details>
    <details><summary>How do payouts work?</summary><p>Rewards are credited within 72 hours after announcement.</p></details>
    <details><summary>Anti-fraud</summary><p>Duplicate or fake signups will be removed; repeated abuse may lead to disqualification.</p></details>
  </div>`;
}

/* COMMUNITY (same as before) */
function renderCommunity(){
  const socials=[
    {name:'Facebook',  url:'https://facebook.com/yourbrand',  icon:'facebook'},
    {name:'Instagram', url:'https://instagram.com/yourbrand', icon:'instagram'},
    {name:'Pinterest', url:'https://pinterest.com/yourbrand', icon:'pinterest'},
    {name:'Telegram',  url:'https://t.me/yourchannel',        icon:'telegram'},
    {name:'Threads',   url:'https://www.threads.net/@yourid', icon:'threads'},
    {name:'Whatsapp',  url:'https://wa.me/?text='+encodeURIComponent('Join the Referral Race: '+location.href), icon:'whatsapp'},
    {name:'X',         url:'https://twitter.com/yourbrand',   icon:'x'},
    {name:'Youtube',   url:'https://youtube.com/@yourbrand',  icon:'youtube'}
  ];
  function iconSVG(key){
    const s={facebook:'<svg viewBox="0 0 24 24"><path fill="#1877F2" d="M24 12.07C24 5.405 18.627 0 12 0S0 5.405 0 12.07C0 18.1 4.388 23.093 10.125 24v-8.44H7.078v-3.49h3.047V9.413c0-3.017 1.792-4.687 4.533-4.687 1.313 0 2.686.235 2.686.235v2.97h-1.514c-1.492 0-1.956.929-1.956 1.884v2.26h3.328l-.532 3.49h-2.796V24C19.612 23.093 24 18.1 24 12.07z"/></svg>',
      instagram:'<svg viewBox="0 0 24 24"><defs><linearGradient id="ig" x1="0" y1="0" x2="1" y2="1"><stop offset="0%" stop-color="#feda75"/><stop offset="50%" stop-color="#d62976"/><stop offset="100%" stop-color="#4f5bd5"/></linearGradient></defs><rect x="2" y="2" width="20" height="20" rx="5" fill="url(#ig)"/><circle cx="12" cy="12" r="4.5" fill="#fff"/><circle cx="17.2" cy="6.8" r="1.3" fill="#fff"/></svg>',
      pinterest:'<svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="11" fill="#E60023"/><path fill="#fff" d="M12.24 7.5c-2.67 0-4.01 1.92-4.01 3.52 0 .97.37 1.82 1.16 2.14.13.05.24 0 .28-.14.02-.1.09-.37.12-.48.04-.14.02-.19-.08-.31-.23-.27-.38-.62-.38-1.12 0-1.44 1.08-2.73 2.82-2.73 1.54 0 2.39.94 2.39 2.2 0 1.65-.73 3.05-1.82 3.05-.6 0-1.05-.5-.9-1.12.17-.71.5-1.48.5-1.99 0-.46-.25-.85-.78-.85-.62 0-1.11.63-1.11 1.48 0 .54.18.9.18.9s-.6 2.52-.7 2.96c-.21.9-.03 2 .03 2.1.02.03.03.03.05.02.02 0 .77-1 .99-1.93.07-.29.39-1.54.39-1.54.19.36.76.68 1.36.68 1.79 0 3.01-1.64 3.01-3.84 0-1.66-1.41-3.2-3.54-3.2z"/></svg>',
      telegram:'<svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="11" fill="#27A7E7"/><path fill="#fff" d="M9.7 17.3l.3-3.2 7.3-6.6c.3-.3-.1-.4-.5-.2l-9 5.7-3.1-1c-.7-.2-.7-.7.1-1l12.1-4.7c.6-.2 1.1.1.9 1l-2.1 10.6c-.1.7-.5.9-1.1.6l-3-2.2-2 1.9c-.1.2-.5.1-.7 0z"/></svg>',
      threads:'<svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="11" fill="#000"/><path fill="#fff" d="M16.9 11.8c-.2-2.5-1.8-4.1-4.5-4.1-1.8 0-3.1.7-3.8 2l2 .9c.3-.7.8-1 1.7-1 1.3 0 2 .7 2.1 1.9-1-.3-2.1-.4-3.2-.1-2 .6-2.6 2.2-2.2 3.5.4 1.4 1.9 2.3 3.7 2.3 1.3 0 2.4-.4 3.1-1.1.1.4.3.8.6 1.2l1.7-1.2c-.5-.7-.9-1.5-1-.2 0-.7 0-1.3-.2-2zM12.2 15c-.9 0-1.5-.4-1.7-1-.2-.7.3-1.3 1.2-1.6.8-.2 1.7-.2 2.6 0-.1 1.3-1 2.6-2.1 2.6z"/></svg>',
      whatsapp:'<svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="11" fill="#25D366"/><path fill="#fff" d="M17.8 13.35c-.18-.1-1.08-.58-1.25-.64-.17-.06-.3-.1-.43.1-.13.2-.49.64-.6.77-.11.13-.22.15-.4.05-.18-.1-.77-.31-1.46-.9-.54-.48-.9-1.08-1.01-1.26-.11-.18-.01-.28.08-.37.08-.08.18-.2.27-.29.09-.1.12-.17.18-.28.06-.12.03-.21-.02-.3-.05-.09-.43-.92-.59-1.26-.15-.33-.31-.28-.43-.28h-.37c-.13 0-.32.05-.49.23-.17.18-.65.63-.65 1.52s.67 1.76.77 1.88c.1.12 1.33 1.98 3.22 2.78.45.19.8.3 1.08.39.45.14.86.12 1.19.08.36-.05 1.11-.44 1.27-.86.16-.42.16-.78.11-.86-.05-.08-.18-.12-.36-.21z"/></svg>',
      x:'<svg viewBox="0 0 24 24"><rect x="2" y="2" width="20" height="20" rx="5" fill="#000"/><path fill="#fff" d="M6 6l6.3 8.3L10 18h2.1l1.5-2.2L18 18h2l-6.7-8.7L16 6h-2l-1.3 2-1 1.5L9 6H6z"/></svg>',
      youtube:'<svg viewBox="0 0 24 24"><rect x="2" y="5" width="20" height="14" rx="4" fill="#FF0000"/><path fill="#fff" d="M10 9l6 3-6 3z"/></svg>'
    };
    return s[key]||s['x'];
  }
  const rows = socials.map(s=>`<div class="socialItem"><div class="sLeft"><div class="sIcon">${iconSVG(s.icon)}</div><div class="sName">${s.name}</div></div><a class="subBtn" href="${s.url}" target="_blank" rel="noopener">Subscribe</a></div>`).join('');
  $('#view').innerHTML = `<div class="card"><h2>Share & Follow</h2><p>Invite friends and follow us.</p></div><div class="socialCard">${rows}</div>`;
}

/* tabs */
$all('.tab').forEach(btn=> btn.addEventListener('click', ()=>{ state.tab=btn.dataset.tab; render(); }));
render();
</script>
</body>
</html>
